<!doctype html><html lang="en">
 <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>MIME Sniffing Standard</title>
  <link href="https://resources.whatwg.org/standard.css" rel="stylesheet">
  <link href="https://resources.whatwg.org/bikeshed.css" rel="stylesheet">
  <link href="https://resources.whatwg.org/logo-mime.svg" rel="icon">
  <meta content="Bikeshed 1.0.0" name="generator">
  <link href="https://resources.whatwg.org/standard.css" rel="stylesheet">
  <link href="https://resources.whatwg.org/logo-mime.png" rel="icon" type="image/png">
  <link href="https://resources.whatwg.org/logo-mime.svg" rel="icon" type="image/svg+xml">
 <body class="h-entry status-LS">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://whatwg.org/"> <img alt="WHATWG" height="100" src="https://resources.whatwg.org/logo-mime.svg"> </a> </p>
   <h1 class="p-name no-ref" id="title">MIME Sniffing</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard — Last Updated <time class="dt-updated" datetime="2016-03-04">4 March 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><span><a href="https://github.com/whatwg/mimesniff">GitHub whatwg/mimesniff</a> (<a href="https://github.com/whatwg/mimesniff/issues/new">new issue</a>, <a href="https://github.com/whatwg/mimesniff/issues">open issues</a>, <a href="https://www.w3.org/Bugs/Public/buglist.cgi?component=MIME&amp;product=WHATWG&amp;resolution=---">legacy open bugs</a>)</span>
     <dd><span><a href="https://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a></span>
     <dt>Commits:
     <dd><span><a href="https://github.com/whatwg/dom/commits">GitHub whatwg/dom/commits</a></span>
     <dd><span><a href="https://twitter.com/thedomstandard">@thedomstandard</a></span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>blah</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#conformance-requirements"><span class="secno">2</span> <span class="content">Conformance requirements</span></a>
    <li><a href="#terminology"><span class="secno">3</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#understanding-mime-types"><span class="secno">4</span> <span class="content">Understanding MIME types</span></a>
     <ol class="toc">
      <li><a href="#parsing-a-mime-type"><span class="secno">4.1</span> <span class="content">Parsing a MIME type</span></a>
      <li><a href="#serializing-a-mime-type"><span class="secno">4.2</span> <span class="content">Serializing a MIME type</span></a>
      <li><a href="#mime-type-groups"><span class="secno">4.3</span> <span class="content">MIME type groups</span></a>
     </ol>
    <li>
     <a href="#handling-a-resource"><span class="secno">5</span> <span class="content">Handling a resource</span></a>
     <ol class="toc">
      <li><a href="#interpreting-the-resource-metadata"><span class="secno">5.1</span> <span class="content">Interpreting the resource metadata</span></a>
      <li><a href="#reading-the-resource-header"><span class="secno">5.2</span> <span class="content">Reading the resource header</span></a>
     </ol>
    <li>
     <a href="#matching-a-mime-type-pattern"><span class="secno">6</span> <span class="content">Matching a MIME type pattern</span></a>
     <ol class="toc">
      <li><a href="#matching-an-image-type-pattern"><span class="secno">6.1</span> <span class="content">Matching an image type pattern</span></a>
      <li>
       <a href="#matching-an-audio-or-video-type-pattern"><span class="secno">6.2</span> <span class="content">Matching an audio or video type pattern</span></a>
       <ol class="toc">
        <li><a href="#signature-for-mp4"><span class="secno">6.2.1</span> <span class="content">Signature for MP4</span></a>
        <li><a href="#signature-for-webm"><span class="secno">6.2.2</span> <span class="content">Signature for WebM</span></a>
        <li><a href="#signature-for-mp3-without-id3"><span class="secno">6.2.3</span> <span class="content">Signature for MP3 without ID3</span></a>
       </ol>
      <li><a href="#matching-a-font-type-pattern"><span class="secno">6.3</span> <span class="content">Matching a font type pattern</span></a>
      <li><a href="#matching-an-archive-type-pattern"><span class="secno">6.4</span> <span class="content">Matching an archive type pattern</span></a>
     </ol>
    <li>
     <a href="#determining-the-computed-mime-type-of-a-resource"><span class="secno">7</span> <span class="content">Determining the computed MIME type of a resource</span></a>
     <ol class="toc">
      <li><a href="#identifying-a-resource-with-an-unknown-mime-type"><span class="secno">7.1</span> <span class="content">Identifying a resource with an unknown MIME type</span></a>
      <li><a href="#sniffing-a-mislabeled-binary-resource"><span class="secno">7.2</span> <span class="content">Sniffing a mislabeled binary resource</span></a>
      <li><a href="#sniffing-a-mislabeled-feed"><span class="secno">7.3</span> <span class="content">Sniffing a mislabeled feed</span></a>
     </ol>
    <li>
     <a href="#context-specific-sniffing"><span class="secno">8</span> <span class="content">Context-specific sniffing</span></a>
     <ol class="toc">
      <li><a href="#sniffing-in-a-browsing-context"><span class="secno">8.1</span> <span class="content">Sniffing in a browsing context</span></a>
      <li><a href="#sniffing-in-an-image-context"><span class="secno">8.2</span> <span class="content">Sniffing in an image context</span></a>
      <li><a href="#sniffing-in-an-audio-or-video-context"><span class="secno">8.3</span> <span class="content">Sniffing in an audio or video context</span></a>
      <li><a href="#sniffing-in-a-plugin-context"><span class="secno">8.4</span> <span class="content">Sniffing in a plugin context</span></a>
      <li><a href="#sniffing-in-a-style-context"><span class="secno">8.5</span> <span class="content">Sniffing in a style context</span></a>
      <li><a href="#sniffing-in-a-script-context"><span class="secno">8.6</span> <span class="content">Sniffing in a script context</span></a>
      <li><a href="#sniffing-in-a-font-context"><span class="secno">8.7</span> <span class="content">Sniffing in a font context</span></a>
      <li><a href="#sniffing-in-a-text-track-context"><span class="secno">8.8</span> <span class="content">Sniffing in a text track context</span></a>
      <li><a href="#sniffing-in-a-cache-manifest-context"><span class="secno">8.9</span> <span class="content">Sniffing in a cache manifest context</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno"></span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="no-num no-toc heading settled" id="table-of-contents"><span class="content">Table of contents</span></h2>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p> The HTTP <code>Content-Type</code> header field is intended to indicate the
 MIME type of an HTTP response. </p>
   <p>However, many HTTP servers supply a <code>Content-Type</code> header field
 value that does not match the actual contents of the response.</p>
   <p>Historically, web browsers have tolerated these servers by examining the
 content of HTTP responses in addition to the <code>Content-Type</code> header
 field in order to determine the effective MIME type of the response.</p>
   <p> Without a clear specification for how to "sniff" the MIME type, each user
 agent has been forced to reverse-engineer the algorithms of other user agents
 in order to maintain interoperability. </p>
   <p>Inevitably, these efforts have not been entirely successful, resulting in
 divergent behaviors among user agents.</p>
   <p>In some cases, these divergent behaviors have had security implications, as a
 user agent could interpret an HTTP response as a different MIME type than
 the server intended.</p>
   <p> These security issues are most severe when an "honest" server allows
 potentially malicious users to upload their own files and then serves the
 contents of those files with a low-privilege MIME type. </p>
   <p>For example, if a server believes that the client will treat a contributed
 file as an image (and thus treat it as benign), but a user agent believes the
 content to be HTML (and thus privileged to execute any scripts contained
 therein), an attacker might be able to steal the user’s authentication
 credentials and mount other cross-site scripting attacks.</p>
   <p>(Malicious servers, of course, can specify an arbitrary MIME type in the <code>Content-Type</code> header field.)</p>
   <p> This document describes a content sniffing algorithm that carefully balances
 the compatibility needs of user agent with the security constraints imposed
 by existing web content.
 The algorithm originated from research conducted by Adam Barth, Juan
 Caballero, and Dawn Song, based on content sniffing algorithms present in
 popular user agents, an extensive database of existing web content, and
 metrics collected from implementations deployed to a sizable number of users. <a data-link-type="biblio" href="#biblio-seccontsniff">[SECCONTSNIFF]</a> </p>
   <h2 class="heading settled" data-level="2" id="conformance-requirements"><span class="secno">2. </span><span class="content">Conformance requirements</span><a class="self-link" href="#conformance-requirements"></a></h2>
   <p> The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
 "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
 document are to be interpreted as described in RFC 2119. </p>
   <p>For readability, these keywords will generally not appear in all uppercase
 letters.</p>
   <p><a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
   <p> Requirements phrased in the imperative as part of algorithms (such as "strip
 any leading space characters" or "return false and abort these steps") are to
 be interpreted with the meaning of the keyword used in introducing the
 algorithm. </p>
   <p> Conformance requirements phrased as algorithms or specific steps can be
 implemented in any manner, so long as the end result is equivalent. </p>
   <p>In particular, note that the algorithms defined in this specification are
 intended to be easy to understand and are not intended to be performant.</p>
   <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="byte">byte<a class="self-link" href="#byte"></a></dfn> is a <span data-anolis-spec="encoding">byte</span> as defined
 in the Encoding Standard.
 When helpful, a <span>byte</span> will be accompanied by information about
 the ASCII code point it represents. <a data-link-type="biblio" href="#biblio-encoding">[ENCODING]</a> <a data-link-type="biblio" href="#biblio-rfc20">[RFC20]</a> </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="binary-data-byte">binary data byte<a class="self-link" href="#binary-data-byte"></a></dfn> is a <span>byte</span> in the range 0x00 to
 0x08 (NUL to BS), the <span>byte</span> 0x0B (VT), a <span>byte</span> in the
 range 0x0E to 0x1A (SO to SUB), or a <span>byte</span> in the range 0x1C to
 0x1F (FS to US). </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="whitespace-byte">whitespace byte<a class="self-link" href="#whitespace-byte"></a></dfn> (abbreviated <abbr title="whitespace byte">0xWS</abbr>) is any one of the following <span title="byte">bytes</span>: 0x09 (HT), 0x0A (LF), 0x0C (FF), 0x0D (CR),
 0x20 (SP). </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="tag-terminating-byte">tag-terminating byte<a class="self-link" href="#tag-terminating-byte"></a></dfn> (abbreviated <abbr title="tag-terminating byte">0xTT</abbr>) is any one of the following <span title="byte">bytes</span>: 0x20 (SP), 0x3E ("<code title="">></code>"). </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="byte-sequence">byte sequence<a class="self-link" href="#byte-sequence"></a></dfn> is a list of one or more <span title="byte">bytes</span>, such that the position of the first <span>byte</span> and the position of the last <span>byte</span> are
 unambiguously identifiable. </p>
   <p> <dfn data-dfn-type="dfn" data-noexport="" id="converting-a-string-to-ascii-lowercase" title="converted to ASCII lowercase">Converting a string to ASCII
 lowercase<a class="self-link" href="#converting-a-string-to-ascii-lowercase"></a></dfn> is accomplished by <span data-anolis-spec="html" title="converted to ASCII lowercase">converting a
 string to ASCII lowercase</span> as defined in the HTML Standard. <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p> Equations are using the mathematical operators as defined in <a data-link-type="biblio" href="#biblio-encoding">[ENCODING]</a>. In addition, the bitwise NOT is
  represented by ~. </p>
   <h2 class="heading settled" data-level="4" id="understanding-mime-types"><span class="secno">4. </span><span class="content">Understanding MIME types</span><a class="self-link" href="#understanding-mime-types"></a></h2>
   <p> The <dfn data-dfn-type="dfn" data-noexport="" id="mime-type">MIME type<a class="self-link" href="#mime-type"></a></dfn> of a <span>resource</span> is a technical hint
 about the use and format of that <span>resource</span>. <a data-link-type="biblio" href="#biblio-rfc2046">[RFC2046]</a> </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="parsable-mime-type">parsable MIME type<a class="self-link" href="#parsable-mime-type"></a></dfn> is a <span>MIME type</span> for which the <span>parse a MIME type</span> algorithm does not return undefined. </p>
   <p>Every <span>parsable MIME type</span> has a corresponding <dfn data-dfn-type="dfn" data-noexport="" id="parsed-mime-type">parsed MIME
 type<a class="self-link" href="#parsed-mime-type"></a></dfn>, which is the result of <span title="parse a MIME type">parsing</span> the <span>parsable MIME
 type</span>.</p>
   <p>A <span>parsed MIME type</span> is made up of a <dfn data-dfn-type="dfn" data-noexport="" id="type">type<a class="self-link" href="#type"></a></dfn>, a <dfn data-dfn-type="dfn" data-noexport="" id="subtype">subtype<a class="self-link" href="#subtype"></a></dfn>, and a dictionary of <dfn data-dfn-type="dfn" data-noexport="" id="parameters">parameters<a class="self-link" href="#parameters"></a></dfn>.</p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="serialized-mime-type">serialized MIME type<a class="self-link" href="#serialized-mime-type"></a></dfn> is the result of <span title="serialize a MIME type">serializing</span> a <span>parsed MIME
 type</span>. </p>
   <p> The <dfn data-dfn-type="dfn" data-noexport="" id="mime-type-portion">MIME type portion<a class="self-link" href="#mime-type-portion"></a></dfn> of a <span>parsable MIME type</span> is the
 result of <span title="serialize a MIME type">serializing</span> the <span>type</span> and <span>subtype</span> of its <span>parsed MIME
 type</span> with null <span>parameters</span>. </p>
   <p class="note" role="note"> The <span>MIME type portion</span> of a <span>parsable MIME type</span> excludes any and all <span>parameters</span>. </p>
   <p> A <span>parsable MIME type</span> is <dfn data-dfn-type="dfn" data-noexport="" id="supported-by-the-user-agent">supported by the user agent<a class="self-link" href="#supported-by-the-user-agent"></a></dfn> if the user agent has the capability to interpret a <span>resource</span> of
 that <span>MIME type</span> and present it to the user. </p>
   <h3 class="heading settled" data-level="4.1" id="parsing-a-mime-type"><span class="secno">4.1. </span><span class="content">Parsing a MIME type</span><a class="self-link" href="#parsing-a-mime-type"></a></h3>
   <p> To <dfn data-dfn-type="dfn" data-noexport="" id="parse-a-mime-type">parse a MIME type<a class="self-link" href="#parse-a-mime-type"></a></dfn>, the user agent must execute the following
 steps: </p>
   <ol>
    <li> Let <var>sequence</var> be the <span>byte sequence</span> of the <span>MIME
   type</span>, where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>. 
    <li> If the number of <span title="byte">bytes</span> in <var>sequence</var> is
   less than 1, return undefined. 
    <li> Initialize <var>s</var> to 0. 
    <li> Initialize <var>type</var> and <var>subtype</var> to the empty string
   ("<code title=""></code>"). 
    <li> Initialize <var>parameters</var> to the empty dictionary ({}). 
    <li>
      While <var>sequence</var>[<var>s</var>] is a <span>whitespace
   character</span>, continuously execute the following steps: 
     <ol>
      <li> Increment <var>s</var> by 1. 
      <li> If <var>sequence</var>[<var>s</var>] is undefined, return undefined. 
     </ol>
    <li class="XXX"> Initialize <var>t</var> to 0. 
    <li>
      While <var>sequence</var>[<var>s</var>] is not equal to the U+002F SOLIDUS
   character ("<code title="">/</code>"), continuously execute the
   following steps: 
     <ol>
      <li class="XXX"> If <var>t</var> is greater than 127, return undefined. 
      <li> If <var>sequence</var>[<var>s</var>] is undefined, return undefined. 
      <li> Append <var>sequence</var>[<var>s</var>], <span>converted to ASCII
     lowercase</span>, to <var>type</var>. 
      <li> Increment <var>s</var> <span class="XXX">and <var>t</var></span> by 1. 
     </ol>
    <li> Increment <var>s</var> by 1. 
    <li class="XXX"> Initialize <var>u</var> to 0. 
    <li>
      While <var>sequence</var>[<var>s</var>] is not a <span>whitespace
   character</span> and is not equal to the U+003B SEMICOLON character
   ("<code title="">;</code>"), continuously execute the following steps: 
     <ol>
      <li class="XXX"> If <var>u</var> is greater than 127, return undefined. 
      <li> If <var>sequence</var>[<var>s</var>] is undefined, return <var>type</var>, <var>subtype</var>, and <var>parameters</var>. 
      <li> Append <var>sequence</var>[<var>s</var>], <span>converted to ASCII
     lowercase</span>, to <var>subtype</var>. 
      <li> Increment <var>s</var> <span class="XXX">and <var>u</var></span> by 1. 
     </ol>
    <li>
      Enter loop <var>L</var>: 
     <ol>
      <li>
        Enter loop <var>M</var>: 
       <ol>
        <li> If <var>sequence</var>[<var>s</var>] is undefined or is equal to the
        U+003B SEMICOLON character ("<code>;</code>"), exit loop <var>M</var>. 
        <li>
          While <var>sequence</var>[<var>s</var>] is a <span>whitespace
        character</span>, continuously execute the following steps: 
         <ol>
          <li> Increment <var>s</var> by 1. 
         </ol>
        <li>
          If <var>sequence</var>[<var>s</var>] is equal to the U+0022 QUOTATION
        MARK character ("<code title="">"</code>"), execute the following
        steps: 
         <ol>
          <li> Increment <var>s</var> by 1. 
          <li>
            Enter loop <var>N</var>: 
           <ol>
            <li>
              If <var>sequence</var>[<var>s</var>] is undefined or is equal to
            the U+0022 QUOTATION MARK character
            ("<code title="">"</code>"), execute the following steps: 
             <ol>
              <li> If <var>sequence</var>[<var>s</var>] is equal to the U+0022
              QUOTATION MARK character ("<code title="">"</code>"),
              increment <var>s</var> by 1. 
              <li> Exit loop <var>N</var>. 
             </ol>
            <li> If <var>sequence</var>[<var>s</var>] is equal to the U+005C
            REVERSE SOLIDUS character ("<code title="">\</code>") and <var>sequence</var>[<var>s</var> + 1] is not undefined, increment <var>s</var> by 1. 
            <li> Increment <var>s</var> by 1. 
           </ol>
         </ol>
         <p>Otherwise, enter loop <var>N</var>:</p>
         <ol>
          <li> If <var>sequence</var>[<var>s</var>] is undefined or is a <span>whitespace character</span> or is equal to the U+003B
          SEMICOLON character ("<code>;</code>"), exit loop <var>N</var>. 
          <li> Increment <var>s</var> by 1. 
         </ol>
       </ol>
      <li> If <var>sequence</var>[<var>s</var>] is undefined, return <var>type</var>, <var>subtype</var>, and <var>parameters</var>. 
      <li> Increment <var>s</var> by 1. 
      <li>
        While <var>sequence</var>[<var>s</var>] is a <span>whitespace
      character</span>, continuously execute the following steps: 
       <ol>
        <li> Increment <var>s</var> by 1. 
       </ol>
      <li> Initialize <var>name</var> and <var>extra</var> to the empty string
      ("<code title=""></code>"). 
      <li class="XXX"> Initialize <var>p</var> to 0. 
      <li>
        Enter loop <var>M</var>: 
       <ol>
        <li class="XXX"> Append <var>extra</var> to <var>name</var>. 
        <li>
          While <var>sequence</var>[<var>s</var>] is not a <span>whitespace
        character</span> and is not equal to the U+003D EQUALS SIGN character
        ("<code title="">=</code>"), continuously execute the following
        steps: 
         <ol>
          <li class="XXX"> If <var>p</var> is greater than 127, return undefined. 
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined, execute the
          following steps: 
           <ol>
            <li> If <var>name</var> is not equal to the empty string
            ("<code title=""></code>") and <var>parameters</var>[<var>name</var>]
            is undefined, set <var>parameters</var>[<var>name</var>] to null. 
            <li> Return <var>type</var>, <var>subtype</var>, and <var>parameters</var>. 
           </ol>
          <li> Append <var>sequence</var>[<var>s</var>], <span>converted to ASCII
          lowercase</span>, to <var>name</var>. 
          <li> Increment <var>s</var> <span class="XXX">and <var>p</var></span> by 1. 
         </ol>
        <li class="XXX">
          While <var>sequence</var>[<var>s</var>] is a <span>whitespace
        character</span>, continuously execute the following steps: 
         <ol>
          <li> Append <var>sequence</var>[<var>s</var>] to <var>extra</var>. 
          <li> Increment <var>s</var> <span class="XXX">and <var>p</var></span> by 1. 
         </ol>
        <li> If <var>sequence</var>[<var>s</var>] is equal to the U+003D EQUALS
        SIGN character ("<code title="">=</code>"), exit loop <var>M</var>. 
       </ol>
      <li> Increment <var>s</var> by 1. 
      <li> Initialize <var>parameters</var>[<var>name</var>] to null. 
      <li>
        While <var>sequence</var>[<var>s</var>] is a <span>whitespace
      character</span>, continuously execute the following steps: 
       <ol>
        <li> Increment <var>s</var> by 1. 
       </ol>
      <li> Initialize <var>value</var> to the empty string ("<code title=""></code>"). 
      <li>
        If <var>sequence</var>[<var>s</var>] is undefined, execute the following
      steps: 
       <ol>
        <li> Set <var>parameters</var>[<var>name</var>] to <var>value</var>. 
        <li> Return <var>type</var>, <var>subtype</var>, and <var>parameters</var>. 
       </ol>
      <li>
        If <var>sequence</var>[<var>s</var>] is equal to the U+0022 QUOTATION
      MARK character ("<code title="">"</code>"), execute the following
      steps: 
       <ol>
        <li> Increment <var>s</var> by 1. 
        <li>
          Enter loop <var>M</var>: 
         <ol>
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined or is equal to the
          U+0022 QUOTATION MARK character ("<code title="">"</code>"),
          execute the following steps: 
           <ol>
            <li> Set <var>parameters</var>[<var>name</var>] to <var>value</var>. 
            <li> If <var>sequence</var>[<var>s</var>] is equal to the U+0022
            QUOTATION MARK character ("<code title="">"</code>"),
            increment <var>s</var> by 1. 
            <li> Exit loop <var>M</var>. 
           </ol>
          <li> If <var>sequence</var>[<var>s</var>] is equal to the U+005C REVERSE
          SOLIDUS character ("<code title="">\</code>") and <var>sequence</var>[<var>s</var> + 1] is not undefined, increment <var>s</var> by 1. 
          <li> Append <var>sequence</var>[<var>s</var>] to <var>value</var>. 
          <li> Increment <var>s</var> by 1. 
         </ol>
       </ol>
       <p>Otherwise, enter loop <var>M</var>:</p>
       <ol>
        <li>
          If <var>sequence</var>[<var>s</var>] is undefined or is a <span>whitespace character</span> or is equal to the U+003B SEMICOLON
        character ("<code>;</code>"), execute the following steps: 
         <ol>
          <li> Set <var>parameters</var>[<var>name</var>] to <var>value</var>. 
          <li> Exit loop <var>M</var>. 
         </ol>
        <li> Append <var>sequence</var>[<var>s</var>] to <var>value</var>. 
        <li> Increment <var>s</var> by 1. 
       </ol>
     </ol>
   </ol>
   <p class="note" role="note"> The <span>parse a MIME type</span> algorithm is intended to be executed after
 any protocol-specific syntax within the <span>MIME type</span> has been
 handled. </p>
   <h3 class="heading settled" data-level="4.2" id="serializing-a-mime-type"><span class="secno">4.2. </span><span class="content">Serializing a MIME type</span><a class="self-link" href="#serializing-a-mime-type"></a></h3>
   <p> To <dfn data-dfn-type="dfn" data-noexport="" id="serialize-a-mime-type">serialize a MIME type<a class="self-link" href="#serialize-a-mime-type"></a></dfn>, given a <var>type</var>, a <var>subtype</var>, and a dictionary of <var>parameters</var>, execute the
 following steps: </p>
   <ol>
    <li> If <var>type</var> is undefined, is null, is equal to the empty string
   ("<code title=""></code>"), or <span class="XXX">has a length greater than
   127</span>, return undefined. 
    <li> If <var>subtype</var> is undefined, is null, or <span class="XXX">has a
   length greater than 127</span>, return undefined. 
    <li> Let <var>serialization</var> be the concatenation of <var>type</var>, the
   U+002F SOLIDUS <span>character</span> ("<code title="">/</code>"), and <var>subtype</var>. 
    <li> If <var>parameters</var> is undefined or is null, return <var>serialization</var>. 
    <li> Let <var>names</var> be a list of the keys in <var>parameters</var>, <span class="XXX">sorted <span title="ASCII case-insensitive">ASCII
   case-insensitively</span> in ascending alphabetical order</span>. 
    <li class="XXX"> Should this special-case the "<code>charset</code>" or
   "<code>codecs</code>" parameters first? 
    <li>
      For each item <var>name</var> in <var>names</var>, execute the following
   steps: 
     <ol>
      <li class="XXX"> If <var>name</var> has a length greater than 127, return undefined. 
      <li>
        If <var>parameters</var>[<var>name</var>] is not null, execute the
     following steps: 
       <ol>
        <li> Append the U+003B SEMICOLON <span>character</span> ("<code title="">;</code>") to <var>serialization</var>. 
        <li> Append <var>name</var>, <span>converted to ASCII lowercase</span>, to <var>serialization</var>. 
        <li> Append the U+003D EQUALS SIGN <span>character</span> ("<code title="">=</code>") to <var>serialization</var>. 
        <li> Append the U+0022 QUOTATION MARK <span>character</span> ("<code title="">"</code>") to <var>serialization</var>. 
        <li>
          For each <span>character</span> <var>char</var> in <var>parameters</var>[<var>name</var>], execute the following steps: 
         <ol>
          <li> If <var>char</var> is equal to the U+0022 QUOTATION MARK <span>character</span> ("<code title="">"</code>") or to the
         U+005C REVERSE SOLIDUS <span>character</span> ("<code title="">\</code>"), append the U+005C REVERSE SOLIDUS <span>character</span> ("<code title="">\</code>") to <var>serialization</var>. 
          <li> Append <var>char</var> to <var>serialization</var>. 
         </ol>
        <li> Append the U+0022 QUOTATION MARK <span>character</span> ("<code title="">"</code>") to <var>serialization</var>. 
        <li> Remove <var>name</var> from <var>names</var>. 
       </ol>
     </ol>
    <li>
      For each item <var>name</var> in <var>names</var>, execute the following
   steps: 
     <ol>
      <li> Append the U+003B SEMICOLON <span>character</span> ("<code title="">;</code>") to <var>serialization</var>. 
      <li> Append <var>name</var>, <span>converted to ASCII lowercase</span>, to <var>serialization</var>. 
     </ol>
    <li class="XXX"> Should this special-case the "<code>base64</code>" boolean parameter last? 
    <li> Return <var>serialization</var>. 
   </ol>
   <h3 class="heading settled" data-level="4.3" id="mime-type-groups"><span class="secno">4.3. </span><span class="content">MIME type groups</span><a class="self-link" href="#mime-type-groups"></a></h3>
   <p> An <dfn data-dfn-type="dfn" data-noexport="" id="image-type">image type<a class="self-link" href="#image-type"></a></dfn> is any <span>parsable MIME type</span> where <span>type</span> is equal to "<code title="">image</code>". </p>
   <p> An <dfn data-dfn-type="dfn" data-noexport="" id="audio-or-video-type">audio or video type<a class="self-link" href="#audio-or-video-type"></a></dfn> is any <span>parsable MIME type</span> where <span>type</span> is equal to "<code title="">audio</code>" or
 "<code title="">video</code>" or where the <span>MIME type portion</span> is
 equal to one of the following: </p>
   <ul>
    <li> <code title="">application/ogg</code> 
   </ul>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="font-type">font type<a class="self-link" href="#font-type"></a></dfn> is any <span>parsable MIME type</span> where
  the <span>MIME type portion</span> is equal to one of the following: </p>
   <ul class="XXX">
    <li> <code title="">application/font-ttf</code> 
    <li> <code title="">application/font-cff</code> 
    <li> <code title="">application/font-off</code> 
    <li> <code title="">application/font-sfnt</code> 
    <li> <code title="">application/vnd.ms-opentype</code> 
    <li> <code title="">application/font-woff</code> 
    <li> <code title="">application/vnd.ms-fontobject</code> 
   </ul>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="zip-based-type">ZIP-based type<a class="self-link" href="#zip-based-type"></a></dfn> is any <span>parsable MIME type</span> where the <span>subtype</span> ends in "<code title="">+zip</code>" or the <span>MIME type
 portion</span> is equal to one of the following: </p>
   <ul class="XXX">
    <li> <code title="">application/zip</code> 
   </ul>
   <p> An <dfn data-dfn-type="dfn" data-noexport="" id="archive-type">archive type<a class="self-link" href="#archive-type"></a></dfn> is any <span>parsable MIME type</span> where
  the <span>MIME type portion</span> is equal to one of the following: </p>
   <ul>
    <li> <code title="">application/x-rar-compressed</code> 
    <li> <code title="">application/zip</code> 
    <li> <code title="">application/x-gzip</code> 
   </ul>
   <p> An <dfn data-dfn-type="dfn" data-noexport="" id="xml-type">XML type<a class="self-link" href="#xml-type"></a></dfn> is any <span>parsable MIME type</span> where the <span>subtype</span> ends in "<code title="">+xml</code>" or the <span>MIME type
 portion</span> is equal to "<code title="">text/xml</code>" or
 "<code title="">application/xml</code>". <a data-link-type="biblio" href="#biblio-rfc3023">[RFC3023]</a> </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="scriptable-mime-type">scriptable MIME type<a class="self-link" href="#scriptable-mime-type"></a></dfn> is an <span>XML type</span> or any <span>parsable MIME type</span> where the <span>MIME type portion</span> is
 equal to one of the following: </p>
   <ul>
    <li> <code title="">text/html</code> 
    <li> <code title="">application/pdf</code> 
   </ul>
   <h2 class="heading settled" data-level="5" id="handling-a-resource"><span class="secno">5. </span><span class="content">Handling a resource</span><a class="self-link" href="#handling-a-resource"></a></h2>
   <p class="XXX"> A <dfn data-dfn-type="dfn" data-noexport="" id="resource">resource<a class="self-link" href="#resource"></a></dfn> is …. </p>
   <p> For each <span>resource</span> it handles, the user agent must keep track of
 the following associated metadata: </p>
   <ul>
    <li> A <dfn data-dfn-type="dfn" data-noexport="" id="supplied-mime-type">supplied MIME type<a class="self-link" href="#supplied-mime-type"></a></dfn>, the <span>MIME type</span> determined by
   the <span>supplied MIME type detection algorithm</span>. 
    <li> A <dfn data-dfn-type="dfn" data-noexport="" id="check-for-apache-bug-flag">check-for-apache-bug flag<a class="self-link" href="#check-for-apache-bug-flag"></a></dfn>, which defaults to unset. 
    <li>
      A <dfn data-dfn-type="dfn" data-noexport="" id="no-sniff-flag">no-sniff flag<a class="self-link" href="#no-sniff-flag"></a></dfn>, which defaults to set if the user agent does
   not wish to perform sniffing on the <span>resource</span> and unset
   otherwise. 
     <p class="note" role="note"> The user agent can choose to use outside information, such as previous
    experience with a site, to determine whether to opt out of sniffing for a
    particular <span>resource</span>. The user agent can also choose to opt
    out of sniffing for all <span title="resource">resources</span>. However,
    opting out of sniffing does not exempt the user agent from using the <span>MIME type sniffing algorithm</span>. </p>
    <li> A <dfn data-dfn-type="dfn" data-noexport="" id="computed-mime-type">computed MIME type<a class="self-link" href="#computed-mime-type"></a></dfn>, the <span>parsable MIME type</span> determined by the <span>MIME type sniffing algorithm</span>. 
   </ul>
   <h3 class="heading settled" data-level="5.1" id="interpreting-the-resource-metadata"><span class="secno">5.1. </span><span class="content">Interpreting the resource metadata</span><a class="self-link" href="#interpreting-the-resource-metadata"></a></h3>
   <p> The <span>supplied MIME type</span> of a <span>resource</span> is provided
 to the user agent by an external source associated with that <span>resource</span>. </p>
   <p>The method of obtaining this information varies depending upon how the <span>resource</span> is retrieved.</p>
   <p> To determine the <span>supplied MIME type</span> of a <span>resource</span>,
 user agents must use the following <dfn data-dfn-type="dfn" data-noexport="" id="supplied-mime-type-detection-algorithm">supplied MIME type detection
 algorithm<a class="self-link" href="#supplied-mime-type-detection-algorithm"></a></dfn>: </p>
   <ol>
    <li> Let <var>supplied-type</var> be null. 
    <li>
      If the <span>resource</span> is retrieved via HTTP, execute the following
   steps: 
     <ol>
      <li>
        If one or more <code>Content-Type</code> headers are associated with the <span>resource</span>, execute the following steps: 
       <ol>
        <li>
          Set <var>supplied-type</var> to the value of the last <code>Content-Type</code> header associated with the <span>resource</span>. 
         <p class="note" role="note"> File extensions are not used to determine the <span>supplied MIME
        type</span> of a <span>resource</span> retrieved via HTTP because they are
        unreliable and easily spoofed. </p>
        <li>
          Set the <span>check-for-apache-bug flag</span> if <var>supplied-type</var> is <strong>exactly</strong> equal to one of
       the values in the following table: 
         <table>
          <thead>
           <tr>
            <th>Bytes in Hexadecimal
            <th>Bytes in ASCII
          <tbody>
           <tr>
            <td> 74 65 78 74 2F 70 6C 61 69 6E 
            <td> <code title="">text/plain</code> 
           <tr>
            <td> 74 65 78 74 2F 70 6C 61 69 6E<br> 3B 20 63 68 61 72 73 65 74 3D<br> 49 53 4F 2D 38 38 35 39 2D 31 
            <td> <code title="">text/plain; charset=ISO-8859-1</code> 
           <tr>
            <td> 74 65 78 74 2F 70 6C 61 69 6E<br> 3B 20 63 68 61 72 73 65 74 3D<br> 69 73 6F 2D 38 38 35 39 2D 31 
            <td> <code title="">text/plain; charset=iso-8859-1</code> 
           <tr>
            <td> 74 65 78 74 2F 70 6C 61 69 6E<br> 3B 20 63 68 61 72 73 65 74 3D<br> 55 54 46 2D 38 
            <td> <code title="">text/plain; charset=UTF-8</code> 
         </table>
         <p class="note" role="note"> The <span>supplied MIME type detection algorithm</span> detects these
        exact <span>byte</span> sequences because some older installations of
        Apache contain <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=13986">a
        bug</a> that causes them to supply one of these Content-Type headers
        when serving files with unrecognized <span title="MIME type">MIME
        types</span>. </p>
       </ol>
      <li> If one or more <code>X-Content-Type-Options</code> headers are associated
     with the <span>resource</span> and any such <code>X-Content-Type-Options</code> header has a value equal to
     "<code title="">nosniff</code>", set the <span>no-sniff flag</span>. 
     </ol>
     <p><a data-link-type="biblio" href="#biblio-http11">[HTTP11]</a></p>
    <li> If the <span>resource</span> is retrieved directly from the file system,
   set <var>supplied-type</var> to the <span>MIME type</span> provided by the
   file system. 
    <li> If the <span>resource</span> is retrieved via another protocol (such as
   FTP), set <var>supplied-type</var> to the <span>MIME type</span> as
   determined by that protocol, if any. <a data-link-type="biblio" href="#biblio-rfc959">[RFC959]</a> 
    <li>
      If <var>supplied-type</var> is not a <span>parsable MIME type</span>, the <span>supplied MIME type</span> is undefined. 
     <p>Abort these steps.</p>
    <li> The <span>supplied MIME type</span> is <var>supplied-type</var>. 
   </ol>
   <h3 class="heading settled" data-level="5.2" id="reading-the-resource-header"><span class="secno">5.2. </span><span class="content">Reading the resource header</span><a class="self-link" href="#reading-the-resource-header"></a></h3>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="resource-header">resource header<a class="self-link" href="#resource-header"></a></dfn> is the <span>byte sequence</span> at the
 beginning of a <span>resource</span>, as determined by <span title="read the resource header">reading the resource header</span>. </p>
   <p> To <dfn data-dfn-type="dfn" data-noexport="" id="read-the-resource-header">read the resource header<a class="self-link" href="#read-the-resource-header"></a></dfn>, perform the following steps: </p>
   <ol>
    <li> Let <var>buffer</var> be a <span>byte sequence</span>. 
    <li>
      Read <span title="byte">bytes</span> of the <span>resource</span> into <var>buffer</var> until one of the following conditions is met: 
     <ul>
      <li> the end of the <span>resource</span> is reached. 
      <li> the number of <span title="byte">bytes</span> in <var>buffer</var> is
     greater than or equal to 1445. 
      <li> a reasonable amount of time has elapsed, as determined by the user
     agent. 
     </ul>
     <p class="note" role="note"> If the number of <span title="byte">bytes</span> in <var>buffer</var> is
    greater than or equal to 1445, the <span>MIME type sniffing
    algorithm</span> will be deterministic for the majority of cases. </p>
     <p>However, certain factors (such as a slow connection) may prevent the
    user agent from reading 512 <span title="byte">bytes</span> in a
    reasonable amount of time.</p>
    <li> The <span>resource header</span> is <var>buffer</var>. 
   </ol>
   <p class="note" role="note"> The <span>resource header</span> need only be determined once per <span>resource</span>. </p>
   <h2 class="heading settled" data-level="6" id="matching-a-mime-type-pattern"><span class="secno">6. </span><span class="content">Matching a MIME type pattern</span><a class="self-link" href="#matching-a-mime-type-pattern"></a></h2>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="byte-pattern">byte pattern<a class="self-link" href="#byte-pattern"></a></dfn> is a <span>byte sequence</span> used as a template
 to be matched against in the <span>pattern matching algorithm</span>. </p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="pattern-mask">pattern mask<a class="self-link" href="#pattern-mask"></a></dfn> is a <span>byte sequence</span> used to determine
 the significance of <span title="byte">bytes</span> being compared against a <span>byte pattern</span> in the <span>pattern matching algorithm</span>. </p>
   <p class="note" role="note"> In a <span>pattern mask</span>, 0xFF indicates the <span>byte</span> is
 strictly significant, 0xDF indicates that the <span>byte</span> is
 significant in an ASCII case-insensitive way, and 0x00 indicates that the <span>byte</span> is not significant. </p>
   <p> To determine whether a <span>byte sequence</span> matches a particular <span>byte pattern</span>, use the following <dfn data-dfn-type="dfn" data-noexport="" id="pattern-matching-algorithm">pattern matching
 algorithm<a class="self-link" href="#pattern-matching-algorithm"></a></dfn>: </p>
   <ol>
    <li> Let <var>sequence</var> be the <span>byte sequence</span> to be matched,
   where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>. 
    <li> Let <var>pattern</var> be the <span>byte pattern</span> to be matched
   against, where <var>pattern</var>[<var>p</var>] is <span>byte</span> <var>p</var> in <var>pattern</var> and <var>pattern</var>[0] is the first <span>byte</span> in <var>pattern</var>. 
    <li> Let <var>mask</var> be the <span>pattern mask</span>, where <var>mask</var>[<var>m</var>] is <span>byte</span> <var>m</var> in <var>mask</var> and <var>mask</var>[0] is the first <span>byte</span> in <var>mask</var>. 
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in <var>pattern</var>, which is equal to the number of <span title="byte">bytes</span> in <var>mask</var>. 
    <li> If the number of <span title="byte">bytes</span> in <var>sequence</var> is
   less than <var>length</var>, return false. 
    <li> Initialize <var>s</var>, <var>p</var>, and <var>m</var> to 0. 
    <li>
      Enter loop <var>L</var>: 
     <ol>
      <li> If <var>sequence</var>[<var>s</var>] is undefined, return false. 
      <li> If <var>sequence</var>[<var>s</var>] is not one of the leading <span title="byte">bytes</span> to be ignored, exit loop <var>L</var>. 
      <li> Increment <var>s</var> by 1. 
     </ol>
    <li>
      Enter loop <var>L</var>: 
     <ol>
      <li> If <var>pattern</var>[<var>p</var>] is undefined, exit loop <var>L</var>. 
      <li> Let <var>masked-data</var> be the result of applying the bitwise AND
     operator to <var>sequence</var>[<var>s</var>] and <var>mask</var>[<var>m</var>]. 
      <li> If <var>masked-data</var> is not equal to <var>pattern</var>[<var>p</var>], return false. 
      <li> Increment <var>s</var>, <var>p</var>, and <var>m</var> by 1. 
     </ol>
    <li> Return true. 
   </ol>
   <h3 class="heading settled" data-level="6.1" id="matching-an-image-type-pattern"><span class="secno">6.1. </span><span class="content">Matching an image type pattern</span><a class="self-link" href="#matching-an-image-type-pattern"></a></h3>
   <p> To determine which <span>image type</span> <span>byte pattern</span> a <span>byte sequence</span> matches, if any, use the following <dfn data-dfn-type="dfn" data-noexport="" id="image-type-pattern-matching-algorithm">image type
 pattern matching algorithm<a class="self-link" href="#image-type-pattern-matching-algorithm"></a></dfn>: </p>
   <ol>
    <li>
      Execute the following steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>byte
       sequence</span> to be matched. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li> If <var>pattern-matched</var> is true, return the value in the fourth
     column of the current row. 
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Image Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 00 00 01 00 
        <td> FF FF FF FF 
        <td> None. 
        <td> <code title="">image/x-icon</code> 
        <td> A Windows Icon signature. 
       <tr>
        <td> 00 00 02 00 
        <td> FF FF FF FF 
        <td> None. 
        <td> <code title="">image/x-icon</code> 
        <td> A Windows Cursor signature. 
       <tr>
        <td> 42 4D 
        <td> FF FF 
        <td> None. 
        <td> <code title="">image/bmp</code> 
        <td> The string "<code title="">BM</code>", a BMP signature. 
       <tr>
        <td> 47 49 46 38 37 61 
        <td> FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">image/gif</code> 
        <td> The string "<code title="">GIF87a</code>", a GIF signature. 
       <tr>
        <td> 47 49 46 38 39 61 
        <td> FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">image/gif</code> 
        <td> The string "<code title="">GIF89a</code>", a GIF signature. 
       <tr>
        <td> 52 49 46 46 00 00 00 00 57 45 42 50 56 50 
        <td> FF FF FF FF 00 00 00 00 FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">image/webp</code> 
        <td> The string "<code title="">RIFF</code>" followed by four <span title="byte">bytes</span> followed by the string
       "<code title="">WEBPVP</code>". 
       <tr>
        <td> 89 50 4E 47 0D 0A 1A 0A 
        <td> FF FF FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">image/png</code> 
        <td> An error-checking <span>byte</span> followed by the string
       "<code title="">PNG</code>" followed by CR LF SUB LF, the PNG signature. 
       <tr>
        <td> FF D8 FF 
        <td> FF FF FF 
        <td> None. 
        <td> <code title="">image/jpeg</code> 
        <td> The JPEG Start of Image marker followed by the indicator <span>byte</span> of another marker. 
     </table>
    <li> Return undefined. 
   </ol>
   <h3 class="heading settled" data-level="6.2" id="matching-an-audio-or-video-type-pattern"><span class="secno">6.2. </span><span class="content">Matching an audio or video type pattern</span><a class="self-link" href="#matching-an-audio-or-video-type-pattern"></a></h3>
   <p> To determine which <span>audio or video type</span> <span>byte pattern</span> a <span>byte sequence</span> matches, if any, use the following <dfn data-dfn-type="dfn" data-noexport="" id="audio-or-video-type-pattern-matching-algorithm">audio or
 video type pattern matching algorithm<a class="self-link" href="#audio-or-video-type-pattern-matching-algorithm"></a></dfn>: </p>
   <ol>
    <li>
      Execute the following steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>byte
       sequence</span> to be matched. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li> If <var>pattern-matched</var> is true, return the value in the fourth
     column of the current row. 
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Audio or Video Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 2E 73 6E 64 
        <td> FF FF FF FF 
        <td> None. 
        <td> <code title="">audio/basic</code> 
        <td> The string "<code title="">.snd</code>", the basic audio signature. 
       <tr>
        <td> 46 4F 52 4D 00 00 00 00 41 49 46 46 
        <td> FF FF FF FF 00 00 00 00 FF FF FF FF 
        <td> None. 
        <td> <code title="">audio/aiff</code> 
        <td> The string "<code title="">FORM</code>" followed by four <span title="byte">bytes</span> followed by the string
       "<code title="">AIFF</code>", the AIFF signature. 
       <tr>
        <td> 49 44 33 
        <td> FF FF FF 
        <td> None. 
        <td> <code title="">audio/mpeg</code> 
        <td> The string "<code title="">ID3</code>", the ID3v2-tagged MP3 signature. 
       <tr>
        <td> 4F 67 67 53 00 
        <td> FF FF FF FF FF 
        <td> None. 
        <td> <code title="">application/ogg</code> 
        <td> The string "<code title="">OggS</code>" followed by NUL, the Ogg container
       signature. 
       <tr>
        <td> 4D 54 68 64 00 00 00 06 
        <td> FF FF FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">audio/midi</code> 
        <td> The string "<code title="">MThd</code>" followed by four <span title="byte">bytes</span> representing the number 6 in 32 bits
       (big-endian), the MIDI signature. 
       <tr>
        <td> 52 49 46 46 00 00 00 00 41 56 49 20 
        <td> FF FF FF FF 00 00 00 00 FF FF FF FF 
        <td> None. 
        <td> <code title="">video/avi</code> 
        <td> The string "<code title="">RIFF</code>" followed by four <span title="byte">bytes</span> followed by the string
       "<code title="">AVI </code>", the AVI signature. 
       <tr>
        <td> 52 49 46 46 00 00 00 00 57 41 56 45 
        <td> FF FF FF FF 00 00 00 00 FF FF FF FF 
        <td> None. 
        <td> <code title="">audio/wave</code> 
        <td> The string "<code title="">RIFF</code>" followed by four <span title="byte">bytes</span> followed by the string
       "<code title="">WAVE</code>", the WAVE signature. 
     </table>
    <li> If the <span>byte sequence</span> to be matched <span>matches the signature
   for MP4</span>, return "<code title="">video/mp4</code>". 
    <li> If the <span>byte sequence</span> to be matched <span>matches the signature
   for WebM</span>, return "<code title="">video/webm</code>". 
    <li> If the <span>byte sequence</span> to be matched <span>matches the signature
   for MP3 without ID3</span>, return "<code title="">audio/mpeg</code>". 
    <li> Return undefined. 
   </ol>
   <h4 class="heading settled" data-level="6.2.1" id="signature-for-mp4"><span class="secno">6.2.1. </span><span class="content">Signature for MP4</span><a class="self-link" href="#signature-for-mp4"></a></h4>
   <p> To determine whether a <span>byte sequence</span> <dfn data-dfn-type="dfn" data-noexport="" id="matches-the-signature-for-mp4">matches the signature
 for MP4<a class="self-link" href="#matches-the-signature-for-mp4"></a></dfn>, use the following steps: </p>
   <ol>
    <li> Let <var>sequence</var> be the <span>byte sequence</span> to be matched,
   where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>. 
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in <var>sequence</var>. 
    <li> If <var>length</var> is less than 12, return false. 
    <li> Let <var>box-size</var> be the four <span title="byte">bytes</span> from <var>sequence</var>[0] to <var>sequence</var>[3], interpreted as a 32-bit
   unsigned big-endian integer. 
    <li> If <var>length</var> is less than <var>box-size</var> or if <var>box-size</var> modulo 4 is not equal to 0, return false. 
    <li> If the four <span title="byte">bytes</span> from <var>sequence</var>[4] to <var>sequence</var>[7] are not equal to 0x66 0x74 0x79 0x70
   ("<code title="">ftyp</code>"), return false. 
    <li> If the three <span title="byte">bytes</span> from <var>sequence</var>[8] to <var>sequence</var>[10] are equal to 0x6D 0x70 0x34
   ("<code title="">mp4</code>"), return true. 
    <li>
      Let <var>bytes-read</var> be 16. 
     <p class="note" role="note"> This ignores the four <span title="byte">bytes</span> that correspond to the
    version number of the "major brand". </p>
    <li>
      While <var>bytes-read</var> is less than <var>box-size</var>, continuously
   loop through these steps: 
     <ol>
      <li> If the three <span title="byte">bytes</span> from <var>sequence</var>[<var>bytes-read</var>] to <var>sequence</var>[<var>bytes-read</var> + 2] are equal to 0x6D 0x70
     0x34 ("<code title="">mp4</code>"), return true. 
      <li> Increment <var>bytes-read</var> by 4. 
     </ol>
    <li> Return false. 
   </ol>
   <h4 class="heading settled" data-level="6.2.2" id="signature-for-webm"><span class="secno">6.2.2. </span><span class="content">Signature for WebM</span><a class="self-link" href="#signature-for-webm"></a></h4>
   <p> To determine whether a <span>byte sequence</span> <dfn data-dfn-type="dfn" data-noexport="" id="matches-the-signature-for-webm">matches the signature
 for WebM<a class="self-link" href="#matches-the-signature-for-webm"></a></dfn>, use the following steps: </p>
   <ol>
    <li> Let <var>sequence</var> be the <span>byte sequence</span> to be matched,
   where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>. 
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in <var>sequence</var>. 
    <li> If <var>length</var> is less than 4, return false. 
    <li> If the four <span title="byte">bytes</span> from <var>sequence</var>[0] to <var>sequence</var>[3], are not equal to 0x1A
   0x45 0xDF 0xA3, return false. 
    <li> Let <var>iter</var> be 4. 
    <li>
      While <var>iter</var> is less than <var>length</var> and <var>iter</var> is
  less than 38, continuously loop through these steps: 
     <ol>
      <li>
        If the two bytes from <var>sequence</var>[<var>iter</var>] to <var>sequence</var>[<var>iter</var> + 1] are equal to 0x42 0x82, 
       <ol>
        <li> Increment <var>iter</var> by 2. 
        <li> If <var>iter</var> is greater or equal than <var>length</var>, abort
      these steps. 
        <li> Let <var>doctype size</var> and <var>number size</var> be the result
      of <a href="#parse-a-vint">parsing a <code>vint</code></a> starting at <var>sequence</var>[<var>iter</var>]. 
        <li> Increment <var>iter</var> by <var>number size</var>. 
        <li> If <var>iter</var> is less than <var>length</var> - 4, abort these
      steps. 
        <li> Let <var>matched</var> be the result of <a href="#matching-a-padded-sequence">matching a padded
        sequence</a> 0x77 0x65 0x62 0x6D
      ("<code title="">webm</code>") on <var>sequence</var> at offset <var>iter</var>. 
        <li> If <var>matched</var> is true, abort these steps and return true. 
       </ol>
      <li> Increment <var>iter</var> by 1. 
     </ol>
    <li> Return false. 
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="parse-a-vint">parse a <code>vint</code><a class="self-link" href="#parse-a-vint"></a></dfn> on a <span>byte sequence</span> <var>sequence</var> of size <var>length</var>, starting at index <var>iter</var> use the following steps:</p>
   <ol>
    <li> Let <var>mask</var> be 128. 
    <li> Let <var>max vint length</var> be 8. 
    <li> Let <var>number size</var> be 1. 
    <li>
      While <var>number size</var> is less than <var>max vint length</var>, and
  less than <var>length</var>, continuously loop through these steps: 
     <ol>
      <li> If the <var>sequence</var>[<var>index</var>] &amp; <var>mask</var> is
    not zero, abort these steps.
      <li> Let <var>mask</var> be the value of <var>mask</var> >> 1. 
      <li> Increment <var>number size</var> by one. 
     </ol>
    <li> Let <var>index</var> be 0. 
    <li> Let <var>parsed number</var> be <var>sequence</var>[<var>index</var>]
  &amp; ~<var>mask</var>. 
    <li> Increment <var>index</var> by one. 
    <li> Let <var>bytes remaining</var> be the value of <var>number size</var>. 
    <li>
      While <var>bytes remaining</var> is not zero, execute there steps: 
     <ol>
      <li> Let <var>parsed number</var> be <var>parsed number</var> &lt;&lt;
      8.
      <li> Let <var>parsed number</var> be <var>parsed number</var> | <var>sequence</var>[<var>index</var>].
      <li> Increment <var>index</var> by one. 
      <li> If <var>index</var> is greater or equal than <var>length</var>, abort
      these steps. 
      <li> Decrement <var>bytes remaining</var> by one.
     </ol>
    <li>Return <var>parsed number</var> and <var>number size</var>
   </ol>
   <p> <dfn data-dfn-type="dfn" data-noexport="" id="matching-a-padded-sequence">Matching a padded sequence<a class="self-link" href="#matching-a-padded-sequence"></a></dfn> <var>pattern</var> on a sequence <var>sequence</var> at starting at byte <var>offset</var> and ending at by <var>end</var> means returning true if <var>sequence</var> has a length greater
than <var>end</var>, and contains exactly, in the range [<var>offset</var>, <var>end</var>], the bytes in <var>pattern</var>, in the same order, eventually
preceded by bytes with a value of 0x00, false otherwise. </p>
   <h4 class="heading settled" data-level="6.2.3" id="signature-for-mp3-without-id3"><span class="secno">6.2.3. </span><span class="content">Signature for MP3 without ID3</span><a class="self-link" href="#signature-for-mp3-without-id3"></a></h4>
   <p>To determine whether a <span>byte sequence</span> <dfn data-dfn-type="dfn" data-noexport="" id="matches-the-signature-for-mp3-without-id3">matches the signature
for MP3 without ID3<a class="self-link" href="#matches-the-signature-for-mp3-without-id3"></a></dfn>, use the following steps:</p>
   <ol>
    <li> Let <var>sequence</var> be the <span>byte sequence</span> to be matched,
  where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>.
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in <var>sequence</var>. 
    <li>Initialize s to 0.
    <li>If the result of the operation <a href="#match-an-mp3-header">match mp3
  header</a> is false, return false.
    <li><a href="#parse-an-mp3-frame">Parse an mp3 frame</a> on <var>sequence</var> at offset <var>s</var>
    <li>Let <var>skipped-bytes</var> the return value of the execution of <a href="#compute-an-mp3-frame-size">mp3 framesize computation</a>
    <li>If <var>skipped-bytes</var> is less than 4, or <var>skipped-bytes</var> is
  greater than <var>s - length</var>, return false.
    <li>Increment s by <var>skipped-bytes</var>.
    <li>If the result of the operation <a href="#match-an-mp3-header">match mp3
  header</a> operation is false, return false, else, return true.
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="match-an-mp3-header">match an mp3 header<a class="self-link" href="#match-an-mp3-header"></a></dfn>, using a <span>byte sequence</span> <var>sequence</var> of length <var>length</var> at offset <var>s</var> execute these steps:</p>
   <ol>
    <li>If <var>length</var> is less than 4, return false.
    <li>If <var>sequence</var>[<var>s</var>] is not equal to 0xff and <var>sequence</var>[<var>s</var> + 1] &amp; 0xe0 is not equal to 0xe0, return
  false.
    <li>Let <var>layer</var> be the result of <var>sequence</var>[<var>s</var> +
  1] &amp; 0x06.
    <li>If <var>layer</var> >> is not 0, return false.
    <li>Let <var>bit-rate</var> be <var>sequence</var>[<var>s</var> + 2] &amp;
  0xf0.
    <li>If <var>bit-rate</var> >> 4 is not 15, return false.
    <li>Let <var>sample-rate</var> be <var>sequence</var>[<var>s</var> + 3] &amp;
  0x0c.
    <li>If <var>sample-rate</var> >> 2 is not 3, return false.
    <li>Let <var>final-layer</var> be the result of 4 -
  (<var>sequence</var>[<var>s</var> + 1])
    <li>If <var>final-layer</var> &amp; 0x06 >> 1 is not 3, return
  false.
    <li>Return true.
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="compute-an-mp3-frame-size">compute an mp3 frame size<a class="self-link" href="#compute-an-mp3-frame-size"></a></dfn>, execute these steps:</p>
   <ol>
    <li>If <var>version</var> is 1, let <var>scale</var> be 72, else, let <var>scale</var> be 144.
    <li>Let <var>size</var> be <var>bitrate</var> * <var>scale</var> / <var>freq</var>.
    <li>If <var>pad</var> is not zero, increment <var>size</var> by 1.
    <li>Return <var>size</var>.
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="parse-an-mp3-frame">parse an mp3 frame<a class="self-link" href="#parse-an-mp3-frame"></a></dfn>, execute these steps:</p>
   <ol>
    <li>Let <var>version</var> be <var>sequence</var>[<var>s</var> + 1] &amp; 0x18
  >> 3.
    <li>Let <var>bitrate-index</var> be sequence[s + 2] &amp; 0xf0 >>
  4.
    <li>If the <var>version</var> &amp; 0x01 is non-zero, let <var>bitrate</var> be the value given by <var>bitrate-index</var> in the table mp2.5-rates
    <li>If <var>version</var> &amp; 0x01 is zero, let <var>bitrate</var> be the
  value given by <var>bitrate-index</var> in the table mp3-rates
    <li>Let <var>samplerate-index</var> be <var>sequence</var>[<var>s</var> + 2]
  &amp; 0x0c >> 2.
    <li>Let <var>samplerate</var> be the value given by <var>samplerate-index</var> in the <var>sample-rate</var> table.
    <li>Let <var>pad</var> be <var>sequence</var>[<var>s</var> + 2] &amp; 0x02
  >> 1.
   </ol>
   <figure>
    <figcaption>mp3-rates table</figcaption>
    <table>
     <thead>
      <tr>
       <th>index
       <th>mp3-rates
     <tbody>
      <tr>
       <td>0
       <td>0
      <tr>
       <td>1
       <td>32000
      <tr>
       <td>2
       <td>40000
      <tr>
       <td>3
       <td>48000
      <tr>
       <td>4
       <td>56000
      <tr>
       <td>5
       <td>64000
      <tr>
       <td>6
       <td>80000
      <tr>
       <td>7
       <td>96000
      <tr>
       <td>8
       <td>112000
      <tr>
       <td>9
       <td>128000
      <tr>
       <td>10
       <td>160000
      <tr>
       <td>11
       <td>192000
      <tr>
       <td>12
       <td>224000
      <tr>
       <td>13
       <td>256000
      <tr>
       <td>14
       <td>320000
    </table>
   </figure>
   <figure>
    <figcaption>mp2.5-rates</figcaption>
    <table>
     <thead>
      <tr>
       <th>index
       <th>mp2.5-rates
     <tbody valign="top">
      <tr>
       <td>0
       <td>0
      <tr>
       <td>1
       <td>8000
      <tr>
       <td>2
       <td>16000
      <tr>
       <td>3
       <td>24000
      <tr>
       <td>4
       <td>32000
      <tr>
       <td>5
       <td>40000
      <tr>
       <td>6
       <td>48000
      <tr>
       <td>7
       <td>56000
      <tr>
       <td>8
       <td>64000
      <tr>
       <td>9
       <td>80000
      <tr>
       <td>10
       <td>96000
      <tr>
       <td>11
       <td>112000
      <tr>
       <td>12
       <td>128000
      <tr>
       <td>13
       <td>144000
      <tr>
       <td>14
       <td>160000
    </table>
   </figure>
   <figure>
    <figcaption>sample-rate table</figcaption>
    <table>
     <thead>
      <tr>
       <th>index
       <th>samplerate
     <tbody>
      <tr>
       <td>0
       <td>44100
      <tr>
       <td>1
       <td>48000
      <tr>
       <td>T2
       <td>32000
    </table>
   </figure>
   <h3 class="heading settled" data-level="6.3" id="matching-a-font-type-pattern"><span class="secno">6.3. </span><span class="content">Matching a font type pattern</span><a class="self-link" href="#matching-a-font-type-pattern"></a></h3>
   <p> To determine which <span>font type</span> <span>byte pattern</span> a <span>byte sequence</span> matches, if any, use the following <dfn data-dfn-type="dfn" data-noexport="" id="font-type-pattern-matching-algorithm">font type
 pattern matching algorithm<a class="self-link" href="#font-type-pattern-matching-algorithm"></a></dfn>: </p>
   <ol>
    <li>
      Execute the following steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>byte
       sequence</span> to be matched. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li> If <var>pattern-matched</var> is true, return the value in the fourth
     column of the current row. 
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Font Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
       00 00 00 00 00 00 00 00 00 00 4C 50 
        <td> 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
       00 00 00 00 00 00 00 00 00 00 FF FF 
        <td> None. 
        <td> <code title="">application/vnd.ms-fontobject</code> 
        <td> 34 <span title="byte">bytes</span> followed by the string
       "<code title="">LP</code>", the Embedded OpenType signature. 
       <tr>
        <td> 00 01 00 00 
        <td> FF FF FF FF 
        <td> None. 
        <td class="XXX"> (TrueType) 
        <td> 4 <span title="byte">bytes</span> representing the version number 1.0, a
       TrueType signature. 
       <tr>
        <td> 4F 54 54 4F 
        <td> FF FF FF FF 
        <td> None. 
        <td class="XXX"> (OpenType) 
        <td> The string "<code title="">OTTO</code>", the OpenType signature. 
       <tr>
        <td> 74 74 63 66 
        <td> FF FF FF FF 
        <td> None. 
        <td class="XXX"> (TrueType Collection) 
        <td> The string "<code title="">ttcf</code>", the TrueType Collection
       signature. 
       <tr>
        <td> 77 4F 46 46 
        <td> FF FF FF FF 
        <td> None. 
        <td> <code title="">application/font-woff</code> 
        <td> The string "<code title="">wOFF</code>", the Web Open Font Format
       signature. 
     </table>
    <li> Return undefined. 
   </ol>
   <h3 class="heading settled" data-level="6.4" id="matching-an-archive-type-pattern"><span class="secno">6.4. </span><span class="content">Matching an archive type pattern</span><a class="self-link" href="#matching-an-archive-type-pattern"></a></h3>
   <p> To determine which <span>archive type</span> <span>byte pattern</span> a <span>byte sequence</span> matches, if any, use the following <dfn data-dfn-type="dfn" data-noexport="" id="archive-type-pattern-matching-algorithm">archive
 type pattern matching algorithm<a class="self-link" href="#archive-type-pattern-matching-algorithm"></a></dfn>: </p>
   <ol>
    <li>
      Execute the following steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>byte
       sequence</span> to be matched. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li> If <var>pattern-matched</var> is true, return the value in the fourth
     column of the current row. 
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Archive Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 1F 8B 08 
        <td> FF FF FF 
        <td> None. 
        <td> <code title="">application/x-gzip</code> 
        <td> The GZIP archive signature. 
       <tr>
        <td> 50 4B 03 04 
        <td> FF FF FF FF 
        <td> None. 
        <td> <code title="">application/zip</code> 
        <td> The string "<code title="">PK</code>" followed by ETX EOT, the ZIP archive
       signature. 
       <tr>
        <td> 52 61 72 20 1A 07 00 
        <td> FF FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">application/x-rar-compressed</code> 
        <td> The string "<code title="">Rar </code>" followed by SUB BEL NUL, the RAR
       archive signature. 
     </table>
    <li> Return undefined. 
   </ol>
   <h2 class="heading settled" data-level="7" id="determining-the-computed-mime-type-of-a-resource"><span class="secno">7. </span><span class="content">Determining the computed MIME type of a resource</span><a class="self-link" href="#determining-the-computed-mime-type-of-a-resource"></a></h2>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span>,
 user agents must use the following <dfn data-dfn-type="dfn" data-noexport="" id="mime-type-sniffing-algorithm">MIME type sniffing algorithm<a class="self-link" href="#mime-type-sniffing-algorithm"></a></dfn>: </p>
   <ol>
    <li> If the <span>supplied MIME type</span> is undefined or if the <span>MIME
   type portion</span> of the <span>supplied MIME type</span> is equal to
   "<code title="">unknown/unknown</code>",
   "<code title="">application/unknown</code>", or "<code title="">*/*</code>",
   execute the <span>rules for identifying an unknown MIME type</span> with
   the <span>sniff-scriptable flag</span> equal to the inverse of the <span>no-sniff flag</span> and abort these steps. 
    <li>
      If the <span>no-sniff flag</span> is set, the <span>computed MIME
   type</span> is the <span>supplied MIME type</span>. 
     <p>Abort these steps.</p>
    <li> If the <span>check-for-apache-bug flag</span> is set, execute the <span>rules for distinguishing if a resource is text or binary</span> and
   abort these steps. 
    <li>
      If the <span>supplied MIME type</span> is an <span>XML type</span>, the <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
     <p>Abort these steps.</p>
    <li> If the <span>MIME type portion</span> of the <span>supplied MIME
   type</span> is equal to "<code title="">text/html</code>", execute the <span>rules for distinguishing if a resource is a feed or HTML</span> and
   abort these steps. 
    <li> If the <span>supplied MIME type</span> is an <span>image type</span> <span>supported by the user agent</span>, let <var>matched-type</var> be
   the result of executing the <span>image type pattern matching
   algorithm</span> with the <span>resource header</span> as the <span>byte
   sequence</span> to be matched. 
    <li>
      If <var>matched-type</var> is not undefined, the <span>computed MIME
   type</span> is <var>matched-type</var>. 
     <p>Abort these steps.</p>
    <li> If the <span>supplied MIME type</span> is an <span>audio or video
   type</span> <span>supported by the user agent</span>, let <var>matched-type</var> be the result of executing the <span>audio or video
   type pattern matching algorithm</span> with the <span>resource
   header</span> as the <span>byte sequence</span> to be matched. 
    <li>
      If <var>matched-type</var> is not undefined, the <span>computed MIME
   type</span> is <var>matched-type</var>. 
     <p>Abort these steps.</p>
    <li> The <span>computed MIME type</span> is the <span>supplied MIME
   type</span>. 
   </ol>
   <h3 class="heading settled" data-level="7.1" id="identifying-a-resource-with-an-unknown-mime-type"><span class="secno">7.1. </span><span class="content">Identifying a resource with an unknown MIME type</span><a class="self-link" href="#identifying-a-resource-with-an-unknown-mime-type"></a></h3>
   <p> The <dfn data-dfn-type="dfn" data-noexport="" id="sniff-scriptable-flag">sniff-scriptable flag<a class="self-link" href="#sniff-scriptable-flag"></a></dfn> is used by the <span>rules for
 identifying an unknown MIME type</span> to determine whether to sniff for <span title="scriptable MIME type">scriptable MIME types</span>. </p>
   <p>If the setting of the <span>sniff-scriptable flag</span> is not specified
 when calling the <span>rules for identifying an unknown MIME type</span>,
 the <span>sniff-scriptable flag</span> must default to unset.</p>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> with an unknown <span>MIME type</span>, execute the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-identifying-an-unknown-mime-type">rules for
 identifying an unknown MIME type<a class="self-link" href="#rules-for-identifying-an-unknown-mime-type"></a></dfn>: </p>
   <ol>
    <li>
      If the <span>sniff-scriptable flag</span> is set, execute the following
   steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>resource
       header</span>. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li>
        If <var>pattern-matched</var> is true, the <span>computed MIME
     type</span> is the value in the fourth column of the current row. 
       <p>Abort these steps.</p>
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Computed MIME Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 3C 21 44 4F 43 54 59 50 45 20 48 54 4D 4C <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF FF DF DF DF DF DF DF DF FF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;!DOCTYPE HTML</code>"
       followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 48 54 4D 4C <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;HTML</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 48 45 41 44 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;HEAD</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 53 43 52 49 50 54 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;SCRIPT</code>" followed by
       a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 49 46 52 41 4D 45 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;IFRAME</code>" followed by
       a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 48 31 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF FF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;H1</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 44 49 56 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;DIV</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 46 4F 4E 54 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;FONT</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 54 41 42 4C 45 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;TABLE</code>" followed by
       a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 41 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;A</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 53 54 59 4C 45 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;STYLE</code>" followed by
       a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 54 49 54 4C 45 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;TITLE</code>" followed by
       a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 42 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;B</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 42 4F 44 59 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;BODY</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 42 52 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;BR</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 50 <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF DF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The case-insensitive string "<code title="">&lt;P</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 21 2D 2D <abbr title="tag-terminating byte">TT</abbr> 
        <td> FF FF FF FF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/html</code> 
        <td> The string "<code title="">&lt;!--</code>" followed by a <span>tag-terminating byte</span>. 
       <tr>
        <td> 3C 3F 78 6D 6C 
        <td> FF FF FF FF FF 
        <td> <span title="whitespace byte">Whitespace bytes</span>. 
        <td> <code title="">text/xml</code> 
        <td> The string "<code title="">&lt;?xml</code>". 
       <tr>
        <td> 25 50 44 46 2D 
        <td> FF FF FF FF FF 
        <td> None. 
        <td> <code title="">application/pdf</code> 
        <td> The string "<code title="">%PDF-</code>", the PDF signature. 
     </table>
     <p class="XXX"> What about feeds? </p>
    <li>
      Execute the following steps for each row in the following table: 
     <ol>
      <li>
        Let <var>pattern-matched</var> be the result of executing the <span>pattern matching algorithm</span> with the following parameters: 
       <ul>
        <li> Let the <span>byte sequence</span> to be matched be the <span>resource
       header</span>. 
        <li> Let the <span>byte pattern</span> to be matched against be the value in
       the first column of the current row. 
        <li> Let the <span>pattern mask</span> be the value in the second column of
       the current row. 
        <li> Let the leading <span title="byte">bytes</span> to be ignored be the
       value in the third column of the current row. 
       </ul>
      <li>
        If <var>pattern-matched</var> is true, the <span>computed MIME
     type</span> is the value in the fourth column of the current row. 
       <p>Abort these steps.</p>
     </ol>
     <table>
      <thead>
       <tr>
        <th> <span>Byte Pattern</span> 
        <th> <span>Pattern Mask</span> 
        <th> Leading <span title="byte">Bytes</span> to Be Ignored 
        <th> <span>Computed MIME Type</span> 
        <th> Note 
      <tbody>
       <tr>
        <td> 25 21 50 53 2D 41 64 6F 62 65 2D 
        <td> FF FF FF FF FF FF FF FF FF FF FF 
        <td> None. 
        <td> <code title="">application/postscript</code> 
        <td> The string "<code title="">%!PS-Adobe-</code>", the PostScript signature. 
       <tr>
        <td> FE FF 00 00 
        <td> FF FF 00 00 
        <td> None. 
        <td> <code title="">text/plain</code> 
        <td> UTF-16BE BOM 
       <tr>
        <td> FF FE 00 00 
        <td> FF FF 00 00 
        <td> None. 
        <td> <code title="">text/plain</code> 
        <td> UTF-16LE BOM 
       <tr>
        <td> EF BB BF 00 
        <td> FF FF FF 00 
        <td> None. 
        <td> <code title="">text/plain</code> 
        <td> UTF-8 BOM 
     </table>
     <p> User agents may implicitly extend this table to support additional <span title="parsable MIME type">parsable MIME types</span>. </p>
     <p>However, user agents should not implicitly extend this table to include
    additional <span title="byte pattern">byte patterns</span> for any <span>computed MIME type</span> already present in this table, as doing so
    could introduce privilege escalation vulnerabilities.</p>
     <p>User agents must not introduce any privilege escalation vulnerabilities
    when extending this table.</p>
    <li> Let <var>matched-type</var> be the result of executing the <span>image type
   pattern matching algorithm</span> with the <span>resource header</span> as
   the <span>byte sequence</span> to be matched. 
    <li>
      If <var>matched-type</var> is not undefined, the <span>computed MIME
   type</span> is <var>matched-type</var>. 
     <p>Abort these steps.</p>
    <li> Let <var>matched-type</var> be the result of executing the <span>audio or
   video type pattern matching algorithm</span> with the <span>resource
   header</span> as the <span>byte sequence</span> to be matched. 
    <li>
      If <var>matched-type</var> is not undefined, the <span>computed MIME
   type</span> is <var>matched-type</var>. 
     <p>Abort these steps.</p>
     <p></p>
    <li> Let <var>matched-type</var> be the result of executing the <span>archive
   type pattern matching algorithm</span> with the <span>resource
   header</span> as the <span>byte sequence</span> to be matched. 
    <li>
      If <var>matched-type</var> is not undefined, the <span>computed MIME
   type</span> is <var>matched-type</var>. 
     <p>Abort these steps.</p>
    <li>
      If the <span>resource header</span> contains no <span title="binary data byte">binary data bytes</span>, the <span>computed
   MIME type</span> is "<code title="">text/plain</code>". 
     <p>Abort these steps.</p>
    <li> The <span>computed MIME type</span> is
   "<code title="">application/octet-stream</code>". 
   </ol>
   <h3 class="heading settled" data-level="7.2" id="sniffing-a-mislabeled-binary-resource"><span class="secno">7.2. </span><span class="content">Sniffing a mislabeled binary resource</span><a class="self-link" href="#sniffing-a-mislabeled-binary-resource"></a></h3>
   <p> To determine whether a binary <span>resource</span> has been mislabeled as
 plain text, execute the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-text-or-binary">rules for
 distinguishing if a resource is text or binary<a class="self-link" href="#rules-for-text-or-binary"></a></dfn>: </p>
   <ol>
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in the <span>resource header</span>. 
    <li>
      If <var>length</var> is greater than or equal to 2 and the first 2 bytes of
  the <span>resource header</span> are equal to 0xFE 0xFF (UTF-16BE BOM) or
  0xFF 0xFE (UTF-16LE BOM), the <span>computed MIME type</span> is
  "<code title="">text/plain</code>". 
     <p>Abort these steps.</p>
    <li>
      If <var>length</var> is greater than or equal to 3 and the first 3 bytes of
  the <span>resource header</span> are equal to 0xEF 0xBB 0xBF (UTF-8 BOM),
  the <span>computed MIME type</span> is "<code title="">text/plain</code>". 
     <p>Abort these steps.</p>
    <li>
      If the <span>resource header</span> contains no <span title="binary data byte">binary data bytes</span>, the <span>computed
  MIME type</span> is "<code title="">text/plain</code>". 
     <p>Abort these steps.</p>
    <li>
      The <span>computed MIME type</span> is
  "<code title="">application/octet-stream</code>". 
     <p class="warning"> It is critical that the <span>rules for distinguishing if a resource is
   text or binary</span> never determine the <span>computed MIME type</span> to be a <span>scriptable MIME type</span>, as this could allow a privilege
   escalation attack. </p>
   </ol>
   <h3 class="heading settled" data-level="7.3" id="sniffing-a-mislabeled-feed"><span class="secno">7.3. </span><span class="content">Sniffing a mislabeled feed</span><a class="self-link" href="#sniffing-a-mislabeled-feed"></a></h3>
   <p> To determine whether a feed has been mislabeled as HTML, execute the
 following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-distinguishing-if-a-resource-is-a-feed-or-html">rules for distinguishing if a resource is a feed or
 HTML<a class="self-link" href="#rules-for-distinguishing-if-a-resource-is-a-feed-or-html"></a></dfn>: </p>
   <ol>
    <li> Let <var>sequence</var> be the <span>resource header</span>, where <var>sequence</var>[<var>s</var>] is <span>byte</span> <var>s</var> in <var>sequence</var> and <var>sequence</var>[0] is the first <span>byte</span> in <var>sequence</var>. 
    <li> Let <var>length</var> be the number of <span title="byte">bytes</span> in <var>sequence</var>. 
    <li> Initialize <var>s</var> to 0. 
    <li> If <var>length</var> is greater than or equal to 3 and the three <span title="byte">bytes</span> from <var>sequence</var>[0] to <var>sequence</var>[2] are equal to 0xEF 0xBB 0xBF (UTF-8 BOM), increment <var>s</var> by 3. 
    <li>
      While <var>s</var> is less than <var>length</var>, continuously loop
   through these steps: 
     <ol>
      <li>
        Enter loop <var>L</var>: 
       <ol>
        <li>
          If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
       MIME type</span> is the <span>supplied MIME type</span>. 
         <p>Abort these steps.</p>
        <li> If <var>sequence</var>[<var>s</var>] is equal to 0x3C
       ("<code title="">&lt;</code>"), increment <var>s</var> by 1 and exit loop <var>L</var>. 
        <li>
          If <var>sequence</var>[<var>s</var>] is not a <span>whitespace
       byte</span>, the <span>computed MIME type</span> is the <span>supplied
       MIME type</span>. 
         <p>Abort these steps.</p>
        <li> Increment <var>s</var> by 1. 
       </ol>
      <li>
        Enter loop <var>L</var>: 
       <ol>
        <li>
          If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
       MIME type</span> is the <span>supplied MIME type</span>. 
         <p>Abort these steps.</p>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 3 and
       the three <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 2] are equal to 0x21 0x2D 0x2D
       ("<code title="">!--</code>"), increment <var>s</var> by 3 and enter loop <var>M</var>: 
         <ol>
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
         MIME type</span> is the <span>supplied MIME type</span>. 
           <p>Abort these steps.</p>
          <li> If <var>length</var> is greater than or equal to <var>s</var> + 3 and
         the three <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 2] are equal to 0x2D 0x2D 0x3E
         ("<code title="">--></code>"), increment <var>s</var> by 3 and exit
         loops <var>M</var> and <var>L</var>. 
          <li> Increment <var>s</var> by 1. 
         </ol>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 1 and <var>sequence</var>[<var>s</var>] is equal to 0x21
       ("<code title="">!</code>"), increment <var>s</var> by 1 and enter loop <var>M</var>: 
         <ol>
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
         MIME type</span> is the <span>supplied MIME type</span>. 
           <p>Abort these steps.</p>
          <li> If <var>length</var> is greater than or equal to <var>s</var> + 1 and <var>sequence</var>[<var>s</var>] is equal to 0x3E
         ("<code title="">></code>"), increment <var>s</var> by 1 and exit loops <var>M</var> and <var>L</var>. 
          <li> Increment <var>s</var> by 1. 
         </ol>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 1 and <var>sequence</var>[<var>s</var>] is equal to 0x3F
       ("<code title="">?</code>"), increment <var>s</var> by 1 and enter loop <var>M</var>: 
         <ol>
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
         MIME type</span> is the <span>supplied MIME type</span>. 
           <p>Abort these steps.</p>
          <li> If <var>length</var> is greater than or equal to <var>s</var> + 2 and
         the two <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 1] are equal to 0x3F 0x3E
         ("<code title="">?></code>"), increment <var>s</var> by 2 and exit loops <var>M</var> and <var>L</var>. 
          <li> Increment <var>s</var> by 1. 
         </ol>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 3 and
       the three <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 2] are equal to 0x72 0x73 0x73
       ("<code title="">rss</code>"), the <span>computed MIME type</span> is
       "<code title="">application/rss+xml</code>". 
         <p>Abort these steps.</p>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 4 and
       the four <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 3] are equal to 0x66 0x65 0x65 0x64
       ("<code title="">feed</code>"), the <span>computed MIME type</span> is
       "<code title="">application/atom+xml</code>". 
         <p>Abort these steps.</p>
        <li>
          If <var>length</var> is greater than or equal to <var>s</var> + 7 and
       the seven <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 6] are equal to 0x72 0x64 0x66 0x3A
       0x52 0x44 0x46 ("<code title="">rdf:RDF</code>"), increment <var>s</var> by 7 and enter loop <var>M</var>: 
         <ol>
          <li>
            If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed
         MIME type</span> is the <span>supplied MIME type</span>. 
           <p>Abort these steps.</p>
          <li>
            If <var>length</var> is greater than or equal to <var>s</var> + 24
         and the twenty-four <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 23] are equal to 0x68 0x74 0x74
         0x70 0x3A 0x2F 0x2F 0x70 0x75 0x72 0x6C 0x2E 0x6F 0x72 0x67 0x2F 0x72
         0x73 0x73 0x2F 0x31 0x2E 0x30 0x2F
         ("<code title="">http://purl.org/rss/1.0/</code>"), increment <var>s</var> by 24 and enter loop <var>N</var>: 
           <ol>
            <li>
              If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed MIME type</span> is the <span>supplied MIME
           type</span>. 
             <p>Abort these steps.</p>
            <li>
              If <var>length</var> is greater than or equal to <var>s</var> + 43
           and the forty-three <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 42] are equal to 0x68 0x74 0x74
           0x70 0x3A 0x2F 0x2F 0x77 0x77 0x77 0x2E 0x77 0x33 0x2E 0x6F 0x72
           0x67 0x2F 0x31 0x39 0x39 0x39 0x2F 0x30 0x32 0x2F 0x32 0x32 0x2D
           0x72 0x64 0x66 0x2D 0x73 0x79 0x6E 0x74 0x61 0x78 0x2D 0x6E 0x73
           0x23
           ("<code title="">http://www.w3.org/1999/02/22-rdf-syntax-ns#</code>"),
           the <span>computed MIME type</span> is
           "<code title="">application/rss+xml</code>". 
             <p>Abort these steps.</p>
            <li> Increment <var>s</var> by 1. 
           </ol>
          <li>
            If <var>length</var> is greater than or equal to <var>s</var> + 24
         and the twenty-four <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 23] are equal to 0x68 0x74 0x74
         0x70 0x3A 0x2F 0x2F 0x77 0x77 0x77 0x2E 0x77 0x33 0x2E 0x6F 0x72 0x67
         0x2F 0x31 0x39 0x39 0x39 0x2F 0x30 0x32 0x2F 0x32 0x32 0x2D 0x72 0x64
         0x66 0x2D 0x73 0x79 0x6E 0x74 0x61 0x78 0x2D 0x6E 0x73 0x23
         ("<code title="">http://www.w3.org/1999/02/22-rdf-syntax-ns#</code>"),
         increment <var>s</var> by 24 and enter loop <var>N</var>: 
           <ol>
            <li>
              If <var>sequence</var>[<var>s</var>] is undefined, the <span>computed MIME type</span> is the <span>supplied MIME
           type</span>. 
             <p>Abort these steps.</p>
            <li>
              If <var>length</var> is greater than or equal to <var>s</var> + 43
           and the forty-three <span title="byte">bytes</span> from <var>sequence</var>[<var>s</var>] to <var>sequence</var>[<var>s</var> + 42] are equal to 0x68 0x74 0x74
           0x70 0x3A 0x2F 0x2F 0x70 0x75 0x72 0x6C 0x2E 0x6F 0x72 0x67 0x2F
           0x72 0x73 0x73 0x2F 0x31 0x2E 0x30 0x2F
           ("<code title="">http://purl.org/rss/1.0/</code>"), the <span>computed
           MIME type</span> is "<code title="">application/rss+xml</code>". 
             <p>Abort these steps.</p>
            <li> Increment <var>s</var> by 1. 
           </ol>
          <li> Increment <var>s</var> by 1. 
         </ol>
        <li>
          The <span>computed MIME type</span> is the <span>supplied MIME
       type</span>. 
         <p>Abort these steps.</p>
       </ol>
     </ol>
    <li> The <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
   </ol>
   <p class="note" role="note"> It might be more efficient for the user agent to implement the <span>rules
 for distinguishing if a resource is a feed or HTML</span> in parallel with
 its algorithm for detecting the character encoding of an HTML document. </p>
   <h2 class="heading settled" data-level="8" id="context-specific-sniffing"><span class="secno">8. </span><span class="content">Context-specific sniffing</span><a class="self-link" href="#context-specific-sniffing"></a></h2>
   <p class="XXX"> A <dfn data-dfn-type="dfn" data-noexport="" id="context">context<a class="self-link" href="#context"></a></dfn> is …. </p>
   <p> In certain <span title="context">contexts</span>, it is only useful to identify <span title="resource">resources</span> that belong to a certain subset of <span title="MIME type">MIME types</span>. </p>
   <p>In such <span title="context">contexts</span>, it is appropriate to use a <span>context-specific sniffing algorithm</span> in place of the <span>MIME
 type sniffing algorithm</span> in order to determine the <span>computed MIME
 type</span> of a <span>resource</span>.</p>
   <p> A <dfn data-dfn-type="dfn" data-noexport="" id="context-specific-sniffing-algorithm">context-specific sniffing algorithm<a class="self-link" href="#context-specific-sniffing-algorithm"></a></dfn> determines the <span>computed MIME type</span> of a <span>resource</span> only if the <span>resource</span> is a <span>MIME type</span> relevant to a particular <span>context</span>. </p>
   <h3 class="heading settled" data-level="8.1" id="sniffing-in-a-browsing-context"><span class="secno">8.1. </span><span class="content">Sniffing in a browsing context</span><a class="self-link" href="#sniffing-in-a-browsing-context"></a></h3>
   <p class="XXX"> Use the <span>MIME type sniffing algorithm</span>. </p>
   <h3 class="heading settled" data-level="8.2" id="sniffing-in-an-image-context"><span class="secno">8.2. </span><span class="content">Sniffing in an image context</span><a class="self-link" href="#sniffing-in-an-image-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> with an <span>image type</span>, execute the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-images-specifically">rules for
 sniffing images specifically<a class="self-link" href="#rules-for-sniffing-images-specifically"></a></dfn>: </p>
   <ol>
    <li>
      If the <span>supplied MIME type</span> is an <span>XML type</span>, the <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
     <p>Abort these steps.</p>
    <li> Let <var>image-type-matched</var> be the result of executing the <span>image type pattern matching algorithm</span> with the <span>resource
   header</span> as the <span>byte sequence</span> to be matched. 
    <li>
      If <var>image-type-matched</var> is not undefined, the <span>computed MIME
   type</span> is <var>image-type-matched</var>. 
     <p>Abort these steps.</p>
    <li> The <span>computed MIME type</span> is the <span>supplied MIME
   type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.3" id="sniffing-in-an-audio-or-video-context"><span class="secno">8.3. </span><span class="content">Sniffing in an audio or video context</span><a class="self-link" href="#sniffing-in-an-audio-or-video-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> with an <span>audio or video type</span>, execute the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-audio-and-video-specifically">rules
 for sniffing audio and video specifically<a class="self-link" href="#rules-for-sniffing-audio-and-video-specifically"></a></dfn>: </p>
   <ol>
    <li>
      If the <span>supplied MIME type</span> is an <span>XML type</span>, the <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
     <p>Abort these steps.</p>
    <li> Let <var>audio-or-video-type-matched</var> be the result of executing the <span>audio or video type pattern matching algorithm</span> with the <span>resource header</span> as the <span>byte sequence</span> to be
   matched. 
    <li>
      If <var>audio-or-video-type-matched</var> is not undefined, the <span>computed MIME type</span> is <var>audio-or-video-type-matched</var>. 
     <p>Abort these steps.</p>
    <li> The <span>computed MIME type</span> is the <span>supplied MIME
   type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.4" id="sniffing-in-a-plugin-context"><span class="secno">8.4. </span><span class="content">Sniffing in a plugin context</span><a class="self-link" href="#sniffing-in-a-plugin-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> <span title="fetch">fetched</span> in a <span>plugin context</span>, execute
 the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-in-a-plugin-context">rules for sniffing in a plugin context<a class="self-link" href="#rules-for-sniffing-in-a-plugin-context"></a></dfn>: </p>
   <ol>
    <li class="XXX"> If the <span>supplied MIME type</span> is undefined, the <span>computed
   MIME type</span> is "<code title="">application/octet-stream</code>". 
    <li> The <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.5" id="sniffing-in-a-style-context"><span class="secno">8.5. </span><span class="content">Sniffing in a style context</span><a class="self-link" href="#sniffing-in-a-style-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> <span title="fetch">fetched</span> in a <span>style context</span>, execute the
 following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-in-a-style-context">rules for sniffing in a style context<a class="self-link" href="#rules-for-sniffing-in-a-style-context"></a></dfn>: </p>
   <ol>
    <li class="XXX"> If the <span>supplied MIME type</span> is undefined, …. 
    <li> The <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.6" id="sniffing-in-a-script-context"><span class="secno">8.6. </span><span class="content">Sniffing in a script context</span><a class="self-link" href="#sniffing-in-a-script-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> <span title="fetch">fetched</span> in a <span>script context</span>, execute
 the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-in-a-script-context">rules for sniffing in a script context<a class="self-link" href="#rules-for-sniffing-in-a-script-context"></a></dfn>: </p>
   <ol>
    <li class="XXX"> If the <span>supplied MIME type</span> is undefined, …. 
    <li> The <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.7" id="sniffing-in-a-font-context"><span class="secno">8.7. </span><span class="content">Sniffing in a font context</span><a class="self-link" href="#sniffing-in-a-font-context"></a></h3>
   <p> To determine the <span>computed MIME type</span> of a <span>resource</span> with a <span>font type</span>, execute the following <dfn data-dfn-type="dfn" data-noexport="" id="rules-for-sniffing-fonts-specifically">rules for sniffing
 fonts specifically<a class="self-link" href="#rules-for-sniffing-fonts-specifically"></a></dfn>: </p>
   <ol>
    <li>
      If the <span>supplied MIME type</span> is an <span>XML type</span>, the <span>computed MIME type</span> is the <span>supplied MIME type</span>. 
     <p>Abort these steps.</p>
    <li> Let <var>font-type-matched</var> be the result of executing the <span>font
   type pattern matching algorithm</span> with the <span>resource
   header</span> as the <span>byte sequence</span> to be matched. 
    <li>
      If <var>font-type-matched</var> is not undefined, the <span>computed MIME
   type</span> is <var>font-type-matched</var>. 
     <p>Abort these steps.</p>
    <li> The <span>computed MIME type</span> is the <span>supplied MIME
   type</span>. 
   </ol>
   <h3 class="heading settled" data-level="8.8" id="sniffing-in-a-text-track-context"><span class="secno">8.8. </span><span class="content">Sniffing in a text track context</span><a class="self-link" href="#sniffing-in-a-text-track-context"></a></h3>
   <p class="XXX"> The <span>computed MIME type</span> is "<code title="">text/vtt</code>". </p>
   <h3 class="heading settled" data-level="8.9" id="sniffing-in-a-cache-manifest-context"><span class="secno">8.9. </span><span class="content">Sniffing in a cache manifest context</span><a class="self-link" href="#sniffing-in-a-cache-manifest-context"></a></h3>
   <p class="XXX"> The <span>computed MIME type</span> is
 "<code title="">text/cache-manifest</code>". </p>
   <h2 class="no-num heading settled" id="acknowledgements"><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p> Special thanks to Adam Barth and Ian Hickson for maintaining previous
 incarnations of this document. </p>
   <p> Thanks also to
 Alfred Hönes,
 Anne van Kesteren,
 Boris Zbarsky,
 David Singer,
 Henri Sivonen,
 Jonathan Neal,
 Joshua Cranmer,
 Larry Masinter,
 Mark Pilgrim,
 Paul Adenot,
 Peter Occil,
 Russ Cox,
 and
 Simon Pieters
 for their invaluable contributions. </p>
   <p>This standard is written by <a href="http://gphemsley.org/">Gordon P. Hemsley</a> (<a href="mailto:me@gphemsley.org">me@gphemsley.org</a>). </p>
   <p>
    Per <a href="https://creativecommons.org/publicdomain/zero/1.0/" rel="license">CC0</a>, to
the extent possible under law, the editor has waived all copyright and related or
neighboring rights to this work. 
<script id="head" src="https://www.whatwg.org/specs/web-apps/current-work/dfn.js"></script>
   </p>
  </main>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#archive-type">archive type</a><span>, in §4.3</span>
   <li><a href="#archive-type-pattern-matching-algorithm">archive
 type pattern matching algorithm</a><span>, in §6.4</span>
   <li><a href="#audio-or-video-type">audio or video type</a><span>, in §4.3</span>
   <li><a href="#audio-or-video-type-pattern-matching-algorithm">audio or
 video type pattern matching algorithm</a><span>, in §6.2</span>
   <li><a href="#binary-data-byte">binary data byte</a><span>, in §3</span>
   <li><a href="#byte">byte</a><span>, in §3</span>
   <li><a href="#byte-pattern">byte pattern</a><span>, in §6</span>
   <li><a href="#byte-sequence">byte sequence</a><span>, in §3</span>
   <li><a href="#check-for-apache-bug-flag">check-for-apache-bug flag</a><span>, in §5</span>
   <li><a href="#compute-an-mp3-frame-size">compute an mp3 frame size</a><span>, in §6.2.3</span>
   <li><a href="#computed-mime-type">computed MIME type</a><span>, in §5</span>
   <li><a href="#context">context</a><span>, in §8</span>
   <li><a href="#context-specific-sniffing-algorithm">context-specific sniffing algorithm</a><span>, in §8</span>
   <li><a href="#converting-a-string-to-ascii-lowercase">Converting a string to ASCII
 lowercase</a><span>, in §3</span>
   <li><a href="#font-type">font type</a><span>, in §4.3</span>
   <li><a href="#font-type-pattern-matching-algorithm">font type
 pattern matching algorithm</a><span>, in §6.3</span>
   <li><a href="#image-type">image type</a><span>, in §4.3</span>
   <li><a href="#image-type-pattern-matching-algorithm">image type
 pattern matching algorithm</a><span>, in §6.1</span>
   <li><a href="#match-an-mp3-header">match an mp3 header</a><span>, in §6.2.3</span>
   <li><a href="#matches-the-signature-for-mp3-without-id3">matches the signature
for MP3 without ID3</a><span>, in §6.2.3</span>
   <li><a href="#matches-the-signature-for-mp4">matches the signature
 for MP4</a><span>, in §6.2.1</span>
   <li><a href="#matches-the-signature-for-webm">matches the signature
 for WebM</a><span>, in §6.2.2</span>
   <li><a href="#matching-a-padded-sequence">Matching a padded sequence</a><span>, in §6.2.2</span>
   <li><a href="#mime-type">MIME type</a><span>, in §4</span>
   <li><a href="#mime-type-portion">MIME type portion</a><span>, in §4</span>
   <li><a href="#mime-type-sniffing-algorithm">MIME type sniffing algorithm</a><span>, in §7</span>
   <li><a href="#no-sniff-flag">no-sniff flag</a><span>, in §5</span>
   <li><a href="#parameters">parameters</a><span>, in §4</span>
   <li><a href="#parsable-mime-type">parsable MIME type</a><span>, in §4</span>
   <li><a href="#parse-a-mime-type">parse a MIME type</a><span>, in §4.1</span>
   <li><a href="#parse-an-mp3-frame">parse an mp3 frame</a><span>, in §6.2.3</span>
   <li><a href="#parse-a-vint">parse a vint</a><span>, in §6.2.2</span>
   <li><a href="#parsed-mime-type">parsed MIME
 type</a><span>, in §4</span>
   <li><a href="#pattern-mask">pattern mask</a><span>, in §6</span>
   <li><a href="#pattern-matching-algorithm">pattern matching
 algorithm</a><span>, in §6</span>
   <li><a href="#read-the-resource-header">read the resource header</a><span>, in §5.2</span>
   <li><a href="#resource">resource</a><span>, in §5</span>
   <li><a href="#resource-header">resource header</a><span>, in §5.2</span>
   <li><a href="#rules-for-distinguishing-if-a-resource-is-a-feed-or-html">rules for distinguishing if a resource is a feed or
 HTML</a><span>, in §7.3</span>
   <li><a href="#rules-for-text-or-binary">rules for
 distinguishing if a resource is text or binary</a><span>, in §7.2</span>
   <li><a href="#rules-for-identifying-an-unknown-mime-type">rules for
 identifying an unknown MIME type</a><span>, in §7.1</span>
   <li><a href="#rules-for-sniffing-audio-and-video-specifically">rules
 for sniffing audio and video specifically</a><span>, in §8.3</span>
   <li><a href="#rules-for-sniffing-fonts-specifically">rules for sniffing
 fonts specifically</a><span>, in §8.7</span>
   <li><a href="#rules-for-sniffing-images-specifically">rules for
 sniffing images specifically</a><span>, in §8.2</span>
   <li><a href="#rules-for-sniffing-in-a-plugin-context">rules for sniffing in a plugin context</a><span>, in §8.4</span>
   <li><a href="#rules-for-sniffing-in-a-script-context">rules for sniffing in a script context</a><span>, in §8.6</span>
   <li><a href="#rules-for-sniffing-in-a-style-context">rules for sniffing in a style context</a><span>, in §8.5</span>
   <li><a href="#scriptable-mime-type">scriptable MIME type</a><span>, in §4.3</span>
   <li><a href="#serialize-a-mime-type">serialize a MIME type</a><span>, in §4.2</span>
   <li><a href="#serialized-mime-type">serialized MIME type</a><span>, in §4</span>
   <li><a href="#sniff-scriptable-flag">sniff-scriptable flag</a><span>, in §7.1</span>
   <li><a href="#subtype">subtype</a><span>, in §4</span>
   <li><a href="#supplied-mime-type">supplied MIME type</a><span>, in §5</span>
   <li><a href="#supplied-mime-type-detection-algorithm">supplied MIME type detection
 algorithm</a><span>, in §5.1</span>
   <li><a href="#supported-by-the-user-agent">supported by the user agent</a><span>, in §4</span>
   <li><a href="#tag-terminating-byte">tag-terminating byte</a><span>, in §3</span>
   <li><a href="#type">type</a><span>, in §4</span>
   <li><a href="#whitespace-byte">whitespace byte</a><span>, in §3</span>
   <li><a href="#xml-type">XML type</a><span>, in §4.3</span>
   <li><a href="#zip-based-type">ZIP-based type</a><span>, in §4.3</span>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-http11"><a class="self-link" href="#biblio-http11"></a>[HTTP11]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
   <dt id="biblio-encoding"><a class="self-link" href="#biblio-encoding"></a>[ENCODING]
   <dd>Anne van Kesteren; Joshua Bell; Addison Phillips. <a href="https://encoding.spec.whatwg.org/">Encoding</a>. 20 October 2015. CR. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-seccontsniff"><a class="self-link" href="#biblio-seccontsniff"></a>[SECCONTSNIFF]
   <dd>Adam Barth; Juan Caballero; Dawn Song. <a href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf">Secure Content Sniffing for Web Browsers, or How to Stop Papers from Reviewing Themselves</a>. URL: <a href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf">http://www.adambarth.com/papers/2009/barth-caballero-song.pdf</a>
   <dt id="biblio-rfc20"><a class="self-link" href="#biblio-rfc20"></a>[RFC20]
   <dd>V.G. Cerf. <a href="https://tools.ietf.org/html/rfc20">ASCII format for network interchange</a>. October 1969. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc20">https://tools.ietf.org/html/rfc20</a>
   <dt id="biblio-rfc2046"><a class="self-link" href="#biblio-rfc2046"></a>[RFC2046]
   <dd>N. Freed; N. Borenstein. <a href="https://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>. November 1996. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc2046">https://tools.ietf.org/html/rfc2046</a>
   <dt id="biblio-rfc3023"><a class="self-link" href="#biblio-rfc3023"></a>[RFC3023]
   <dd>M. Murata; S. St. Laurent; D. Kohn. <a href="https://tools.ietf.org/html/rfc3023">XML Media Types</a>. January 2001. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc3023">https://tools.ietf.org/html/rfc3023</a>
   <dt id="biblio-rfc959"><a class="self-link" href="#biblio-rfc959"></a>[RFC959]
   <dd>J. Postel; J. Reynolds. <a href="https://tools.ietf.org/html/rfc959">File Transfer Protocol</a>. October 1985. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc959">https://tools.ietf.org/html/rfc959</a>
  </dl>